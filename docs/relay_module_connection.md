# Подключение релейного модуля к ESP32

## Модель реле

По фото определено, что используется **5V одноканальный релейный модуль** (вероятно, серия XY-MK или аналогичный):
- **Один канал управления**: вход `IN` управляет одним реле
- **Оптопара**: обеспечивает гальваническую развязку между ESP32 и сильноточной цепью
- **Реле**: голубой блок 10A/250VAC — для коммутации нагрузки (например, помпа увлажнителя)

## Схема подключения

### Пины питания и управления (левый зелёный клеммник):
- **VCC** (или JVcc) — питание модуля **+5V** (от внешнего источника питания)
- **GND** — земля (общая для ESP32 и модуля)
- **IN** — вход управления → **GPIO23** (ESP32)

### Контакты реле (голубой блок):
- **COM** (Common) — общий контакт реле
- **NO** (Normally Open) — размыкающийся контакт (используется при управлении нагрузкой)
- **NC** (Normally Closed) — замыкающийся контакт (редко используется)

### Подключение нагрузки (кранчик увлажнителя):
- Один провод нагрузки → **COM** реле
- Другой провод нагрузки → **NO** реле

## Очень важно: безопасность и питание

⚠️ **Релейный модуль требует отдельного источника питания +5V** (не подключайте к 3.3V ESP32):
- ESP32 может не обеспечить достаточный ток для сотен витков катушки реле
- Используйте отдельный блок питания 5V (например, из USB адаптера или лабораторного БП)

⚠️ **Общая земля (GND) обязательна**:
- Подключите GND модуля к GND ESP32
- Это обеспечит правильный уровень сигнала на входе `IN`

## Рекомендуемое улучшение: подтяжка резистора

При необходимости припаяйте **резистор 10 kΩ между `IN` и `GND`** на плате модуля:
- Предотвращает случайное срабатывание при загрузке ESP32
- Стабилизирует уровень сигнала на входе оптопары

```
      ESP32 GPIO23
           |
          [R 330Ω] (опционально, для подстраховки)
           |
      IN--|+
          |
     GND--|--[R 10kΩ]--|
           |            |
           +----GND-----+
```

## Фото подключения

![Релейный модуль с указанием GPIO23](relay_module_photo.jpg)

**Указан контакт IN** (жёлтый клеммник) — туда подключается GPIO23 ESP32.

## Текущие настройки прошивки

- **GPIO pin**: 23 (задан в `platformio.ini`)
- **Уровень активации**: HIGH (3.3V на входе IN → реле срабатывает)
- **Режим**: активный HIGH (реле включает нагрузку при HIGH на GPIO)

Если потребуется использовать другой GPIO или инвертировать логику, измените `HUM_DEFAULT_RELAY_PIN` и `HUM_DEFAULT_RELAY_INVERTED` в `platformio.ini`.
